<!DOCTYPE html>
<html lang="zh-cmn-Hans">

<head>
    <meta charset="UTF-8" />
    <meta name="renderer" content="webkit" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <title></title>
    <link rel="stylesheet" href="../../dist/layui/css/layui.css" />
    <link rel="stylesheet" href="../../dist/fonts/iconfont.css" />
    <link rel="stylesheet" href="../../css/common.css" />
    <link rel="stylesheet" href="../../css/five/style.css" />
    <script src="../../js/jquery-2.1.1.js"></script>
    <script src="../../dist/layui/layui.all.js"></script>
    <script>
        var layer = layui.layer;
        var form = layui.form;
        var carousel = layui.carousel;
        var laydate = layui.laydate;
        var table = layui.table;
        var laytree = layui.tree;
        var layTreeSelect = layui.treeSelect;
        var layUpload = layui.upload;
        var layElement = layui.element;
    </script>
</head>

<body class="combody">
    <div class="orderNav clearfix">
        <div class="item">
            <div class="text">
                <span>全部工单</span><br>
                <span>10</span>
            </div>
            <div class="text_n">
                <span>今日新增</span><br>
                <span>5</span>
            </div>
        </div>
        <div class="item">
            <div class="text">
                <span>待处理工单</span><br>
                <span>0</span>
            </div>
        </div>
        <div class="item">
            <div class="text">
                <span>处理中工单</span><br>
                <span>3</span>
            </div>
        </div>
        <div class="item">
            <div class="text">
                <span>已完成工单</span><br>
                <span>3</span>
            </div>
        </div>
        <div class="item">
            <div class="text">
                <span>已作废工单</span><br>
                <span>3</span>
            </div>
        </div>
        <div class="add" onclick="addOrder();">
            <i class="iconfont icon-jia"></i>
        </div>
    </div>
    <div class="searchBox">
        <div class="layui-form">
            <div class="layui-form-item layui-inline">
                <input
                type="text"
                name="date"
                id="starDate"
                autocomplete="off"
                placeholder="工单开始时间"
                class="layui-input"
                />
            </div>
            <div class="layui-form-item layui-inline">
                -
            </div>
            <div class="layui-form-item layui-inline">
                <input
                type="text"
                name="date"
                id="endDate"
                autocomplete="off"
                placeholder="工单结束时间"
                class="layui-input"
                />
            </div>
            <div class="layui-form-item layui-inline">
                <select name="company" lay-filter="company" id="company">
                    <option>请选择创建人</option>
                    <option value="0">张三</option>
                    <option value="1">李四</option>
                    <option value="1">王五</option>
                </select>
            </div>
            <div class="layui-form-item layui-inline">
                <select name="company" lay-filter="company" id="company">
                    <option>请选择工单类型</option>
                    <option value="0">保修</option>
                    <option value="1">损坏</option>
                    <option value="1">正常</option>
                </select>
            </div>
            
            <div class="layui-form-item layui-inline">
                <button type="button" class="layui-btn layui-btn-normal">
                    搜索
                </button>
            </div>
        </div>
    </div>
    <div class="p-l-r-15">
        <table class="layui-hide" id="personList" lay-filter="personList"></table>
    </div>

</body>
<script>
    $(function () {
        initTable();
        laydate.render({
            elem: "#starDate",
        });
        laydate.render({
            elem: "#endDate",
        });
        form.render("select");
    });
    function initTable() {
        table.render({
            elem: "#personList",
            data: [
            {
                    number: "NT0010",
                    name: "修理",
                    type: '施工工单',
                    status: "张三",
                    createDate: "2020-05-15",
                    createBy: "李四",
                    department: "工程部",
                    makeTime: "2020-06-05",
                    status: "处理中",
                },
                {
                    number: "NT0010",
                    name: "修理",
                    type: '施工工单',
                    status: "张三",
                    createDate: "2020-05-15",
                    createBy: "李四",
                    department: "工程部",
                    makeTime: "2020-06-05",
                    status: "处理中",
                },
                {
                    number: "NT0010",
                    name: "修理",
                    type: '施工工单',
                    status: "张三",
                    createDate: "2020-05-15",
                    createBy: "李四",
                    department: "工程部",
                    makeTime: "2020-06-05",
                    status: "处理中",
                },
                {
                    number: "NT0010",
                    name: "修理",
                    type: '施工工单',
                    status: "张三",
                    createDate: "2020-05-15",
                    createBy: "李四",
                    department: "工程部",
                    makeTime: "2020-06-05",
                    status: "处理中",
                },
                {
                    number: "NT0010",
                    name: "修理",
                    type: '施工工单',
                    status: "张三",
                    createDate: "2020-05-15",
                    createBy: "李四",
                    department: "工程部",
                    makeTime: "2020-06-05",
                    status: "处理中",
                },
                {
                    number: "NT0010",
                    name: "修理",
                    type: '施工工单',
                    status: "张三",
                    createDate: "2020-05-15",
                    createBy: "李四",
                    department: "工程部",
                    makeTime: "2020-06-05",
                    status: "处理中",
                },
                {
                    number: "NT0010",
                    name: "修理",
                    type: '施工工单',
                    status: "张三",
                    createDate: "2020-05-15",
                    createBy: "李四",
                    department: "工程部",
                    makeTime: "2020-06-05",
                    status: "处理中",
                },
                {
                    number: "NT0010",
                    name: "修理",
                    type: '施工工单',
                    status: "张三",
                    createDate: "2020-05-15",
                    createBy: "李四",
                    department: "工程部",
                    makeTime: "2020-06-05",
                    status: "处理中",
                },
            ],
            cellMinWidth: 80,
            page: true,
            cols: [
                [
                    { field: "number", title: "工单号" },
                    { field: "name", title: "工单名称" },
                    { field: "type", title: "工单类型" },
                    { field: "createBy", title: "创建人" },
                    { field: "createDate", title: "创建时间" },
                    { field: "department", title: "施工部门" },
                    { field: "makeTime", title: "预约工程时间" },
                    { field: "status", title: "工单状态" },
                    {
                        fixed: "right",
                        title: "操作",
                        align: "center",
                        toolbar: "#operList",
                    },
                ],
            ],
        });
        table.on("tool(personList)", function (obj) {
            var data = obj.data;
            //console.log(obj)
            if (obj.event === "del") {
                layer.confirm("确认删除该供应商吗？", function (index) {
                    obj.del();
                    layer.close(index);
                });
            } else if (obj.event === "edit") {
                addData('edit');
            } else if (obj.event === "repair") {
                guarantee(obj.data);
            }
        });
    }
    function addEquipment() {
        layer.open({
            title: '新增供应商',
            content: $("#addEquipment"),
            type: 1,
            area: ['840px', 'auto']
        })
    }
    function guarantee(rowdata) {
        layer.open({
            title: '设备报修',
            content: $("#applyRepair"),
            type: 1,
            area: ['840px', 'auto'],
            btn: ['取消', '提交'],
            yes: function (index, layero) {
                layer.close(index);
            },
            btn2: function (index, layero) {
                layer.msg('报修成功！');
                layer.close(index);
            },
            success: function (res) {
                console.log(res)
            },
            fail: function (error) {
                console.log(error)
            }
        })
    }
    function addOrder(){
        parent.changeSrc('/pages_five/addTask.html');
    }
</script>
<script type="text/html" id="operList">
    <a class="layui-btn layui-btn-xs" lay-event="edit">完成</a>
    <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="tovoid">作废</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
   
  </script>
</html>